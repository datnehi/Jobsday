<div class="container mt-4">
  <div class="card mb-4">
    <div class="card-header bg-primary text-white">
      <h4 class="mb-0">{{ job.title }}</h4>
    </div>
    <div class="card-body" style="padding-bottom: unset;">
      <div class="row mb-2">
        <div class="col-md-4">
          <p><strong>Công ty: </strong><a routerLink="/company-related-info/{{company.id}}">{{ company.name }}</a></p>
          <p><strong>Người phụ trách: </strong><a routerLink="/hr-related-info/{{member.id}}">{{user.fullName}}</a> -
            {{member.position}}</p>
          <p><strong>Địa điểm:</strong> {{ job.location }}</p>
          <p><strong>Địa chỉ:</strong> {{ job.address }}</p>
          <p><strong>Thời gian làm việc:</strong> {{ job.workingTime }}</p>
          <p><strong>Loại công việc:</strong> {{ job.jobType }}</p>
          <p><strong>Cấp bậc:</strong> {{ job.level }}</p>
          <p><strong>Hình thức hợp đồng:</strong> {{ job.contractType }}</p>
          <p><strong>Lương:</strong> {{ job.salary }}</p>
          <p><strong>Kinh nghiệm:</strong> {{ job.experience }}</p>
          <p><strong>Số lượng tuyển:</strong> {{ job.quantity }}</p>
          <p><strong>Hạn nộp:</strong> {{ job.deadline | date:'dd/MM/yyyy' }}</p>
          <p><strong>Trạng thái: </strong><span [ngClass]="{
            'badge bg-primary text-white': job.status === 'ACTIVE',
            'badge bg-secondary text-white': job.status === 'HIDDEN',
            'badge bg-danger text-white': job.status === 'CLOSED',
          }">{{ job.status }}</span></p>
          <button type="button" class="btn btn-danger" (click)="openConfirm('deleteJob')">Xóa Job</button>
        </div>
        <div class="col-md-8">
          <p><strong>Mô tả công việc:</strong></p>
          <div class="border rounded p-2 mb-2" style="height: 25%;">
            <span [innerHTML]="job.description | newlineToBr"></span>
          </div>
          <p><strong>Yêu cầu:</strong></p>
          <div class="border rounded p-2 mb-2" style="height: 25%;">
            <span [innerHTML]="job.requirement | newlineToBr"></span>
          </div>
          <p><strong>Quyền lợi:</strong></p>
          <div class="border rounded p-2" style="height: 25%;">
            <span [innerHTML]="job.benefit | newlineToBr"></span>
          </div>
        </div>
        <div class="text-end text-muted">
          <small>Ngày tạo: {{ job.createdAt | date:'dd/MM/yyyy HH:mm' }} | Cập nhật: {{ job.updatedAt |
            date:'dd/MM/yyyy HH:mm' }}</small>
        </div>
      </div>
    </div>
  </div>

  <h5 class="mb-3 text-center">Danh sách ứng viên đã ứng tuyển</h5>
  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-primary">
        <tr>
          <th scope="col" class="text-center">Họ tên</th>
          <th scope="col" class="text-center">Email</th>
          <th scope="col" class="text-center" style="width: 9em;">Số điện thoại</th>
          <th scope="col" class="text-center" style="width: 10em;">Ngày ứng tuyển</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let application of applications; let i = index" routerLink="/candidate/{{application.candidateId}}"
          style="cursor: pointer;">
          <td class="text-center align-middle">{{ application.candidateName }}</td>
          <td class="text-center align-middle">{{ application.candidateEmail }}</td>
          <td class="text-center align-middle">{{ application.candidatePhone }}</td>
          <td class="text-center align-middle">{{ application.appliedAt | date:'dd/MM/yyyy hh:mm' }}</td>
        </tr>
        <tr *ngIf="applications.length === 0">
          <td colspan="4" class="text-center align-middle">Chưa có ứng viên nào ứng tuyển</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div *ngIf="totalPages > 1" class="d-flex justify-content-center align-items-center gap-3">
    <button class="btn btn-outline-primary rounded-circle px-2" [disabled]="currentPage === 0"
      (click)="changePage(currentPage - 1)" style="width: 36px; height: 36px;" aria-label="Trang trước">
      <i class="bi bi-chevron-left"></i>
    </button>
    <span class="fw-bold text-primary" style="font-size: 1.1rem;">
      {{ currentPage + 1 }} <span class="text-muted">/ {{ totalPages }} trang</span>
    </span>
    <button class="btn btn-outline-primary rounded-circle px-2" [disabled]="currentPage + 1 >= totalPages"
      (click)="changePage(currentPage + 1)" style="width: 36px; height: 36px;" aria-label="Trang sau">
      <i class="bi bi-chevron-right"></i>
    </button>
  </div>
</div>

<app-notification-dialog *ngIf="showConfirmDialog" [title]="confirmTitle" [message]="confirmMessage"
  (confirm)="handleConfirm()" (cancel)="handleCancel()">
</app-notification-dialog>

<app-error-dialog *ngIf="showErrorDialog" [title]="errorTitle" [message]="errorMessage" (cancel)="handleCancelError()">
</app-error-dialog>

<app-loading *ngIf="isLoading"></app-loading>
