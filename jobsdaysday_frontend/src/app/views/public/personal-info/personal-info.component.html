<div class="container py-4" style="max-width:1200px;">
  <div class="row">
    <div class="col-lg-8 mb-4">
      <div class="card shadow-sm mb-4">
        <div class="card-body">
          <h4 class="fw-bold mb-3">Cài đặt thông tin cá nhân</h4>
          <div class="mb-2 text-danger small">
            <span class="fw-bold">*</span> Các thông tin bắt buộc
          </div>
          <form [formGroup]="infoForm" (ngSubmit)="openConfirm()">
            <div class="mb-3">
              <label class="form-label fw-bold">Họ và tên <span class="text-danger">*</span></label>
              <input type="text" class="form-control" formControlName="fullName" name="fullName" required>
              <div *ngIf="infoForm.get('fullName')?.invalid && infoForm.get('fullName')?.touched" class="text-danger">
                Họ và tên không được để trống
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Ngày sinh</label>
              <input type="date" class="form-control" formControlName="dob" name="dob">
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Địa chỉ</label>
              <input type="text" class="form-control" formControlName="address" name="address">
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Số điện thoại</label>
              <input type="text" class="form-control" formControlName="phone" name="phone">
            </div>
            <div class="mb-3" *ngIf="user?.role == 'HR'">
              <label class="form-label fw-bold">Chức vụ</label>
              <input type="text" class="form-control" formControlName="position" name="position">
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Email</label>
              <input type="email" class="form-control" formControlName="email" name="email">
            </div>
            <button type="submit" class="btn btn-primary px-4 fw-bold">Lưu</button>
          </form>
        </div>
      </div>
    </div>

    <div class="col-lg-4 mb-4">
      <div class="card shadow-sm mb-3">
        <div class="card-body">
          <div class="mb-3 d-flex align-items-center gap-3">
            <div class="position-relative d-inline-block" style="width: 96px; height: 96px;">
              <img [src]="user?.avatarUrl || 'assets/user.jpg'" alt="Avatar" width="96" height="96"
                class="rounded-circle border" />
              <button type="button" class="btn btn-light p-1 position-absolute bottom-0 end-0 border-0 shadow"
                style="border-radius: 50%; background: #0d6efd;" (click)="openAvatarDialog()">
                <i class="bi bi-camera-fill text-white"></i>
              </button>
            </div>
            <h4 class="fw-bold text-primary mb-1 mb-0">Chào bạn trở lại, <b>{{ user?.fullName }}</b></h4>
          </div>
          <div *ngIf="user?.role == 'CANDIDATE'">
            <div class="form-check form-switch d-flex align-items-center mb-2">
              <input class="form-check-input me-2" type="checkbox" style="cursor: pointer;" [(ngModel)]="allowNTDSearch"
                id="ntdSearch" (change)="toggleSearchChange()" />
              <label class="form-check-label fw-bold text-primary" for="ntdSearch">
                Cho phép NTD tìm kiếm hồ sơ
              </label>
            </div>
            <ul class="mt-2 text-muted ps-3">
              <li>Nhắn tin qua Jobsday</li>
              <li>Email và Số điện thoại của bạn</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<app-avatar-editor
  [data]="user"
  [visible]="showAvatarEditor"
  (saved)="onAvatarSaved($event)"
  (closed)="onAvatarDialogClosed()">
</app-avatar-editor>

<app-error-dialog
  *ngIf="showErrorDialog"
  [title]="errorTitle"
  [message]="errorMessage"
  (cancel)="handleCancelError()">
</app-error-dialog>

<app-notification-dialog *ngIf="showConfirmDialog" [title]="confirmTitle" [message]="confirmMessage"
  (confirm)="handleConfirm()" (cancel)="handleCancel()">
</app-notification-dialog>

<app-loading *ngIf="isLoading"></app-loading>
